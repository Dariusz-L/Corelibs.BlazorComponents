@using BlazorComponentsLayersTest.ViewModels;
@using static BlazorComponentsLayersTest.Layouts.TreeLayout;

<div class="page">
    <PageMenu OnArrangmentsButton=@OnArrangmentsButton />
    <Arrangements @ref=@_arrangements OnAddNewClick=@OnAddNewArrangmentClick />
    <Arrangements_AddNew @ref=@_arrangements_AddNew Properties=_properties />
    <TreeLayout Tree=Tree LayoutGap=20 />
</div>

@code {
    private Arrangements? _arrangements;
    private Arrangements_AddNew? _arrangements_AddNew;

    private List<IdentityVM> _properties = new();

    protected override void OnInitialized()
    {
        _properties = Tree.Children.Select(n => n.Identity).ToList();
    }

    private void OnArrangmentsButton()
    {
        _arrangements.OuterClickComponent.Enabled = !_arrangements.OuterClickComponent.Enabled;
    }

    private void OnAddNewArrangmentClick()
    {
        _arrangements.OuterClickComponent.Enabled = !_arrangements.OuterClickComponent.Enabled;
        _arrangements_AddNew.OuterClickComponent.Enabled = !_arrangements_AddNew.OuterClickComponent.Enabled;
    }

    public TreeNode? Tree = new TreeNode
    {
        Content = RenderFragmentExtensions.CreateComponent<Property>("Author", "Misa Ammo"),
        Children = new List<TreeNode>
        {
            new TreeNode
            {
                Identity = new IdentityVM("LessonsID", "Lessons"),
                Content = RenderFragmentExtensions.CreateComponent<Property>("Lessons"),
                Children = new List<TreeNode>
                {
                    new TreeNode
                    {
                        Content = RenderFragmentExtensions.CreateComponent<Property>("Lesson", "wa nad ga particles"),
                        Children = new List<TreeNode>
                        {

                        }
                    },
                    new TreeNode
                    {
                        Content = RenderFragmentExtensions.CreateComponent<Property>("Lesson", "tara and nara"),
                        Children = new List<TreeNode>
                        {

                        }
                    },
                    new TreeNode
                    {
                        Content = RenderFragmentExtensions.CreateComponent<Property>("Lesson", "Basic expressions"),
                        Children = new List<TreeNode>
                        {

                        }
                    },
                }
            },

            new TreeNode
            {
                Identity = new IdentityVM("SecondID", "Bah bah"),
                Children = new List<TreeNode>
                {
                    new TreeNode
                    {
                        Content = RenderFragmentExtensions.CreateComponent<Property>("Lesson", "another lesson"),
                        Children = new List<TreeNode>
                        {

                        }
                    },
                    new TreeNode
                    {
                        Content = RenderFragmentExtensions.CreateComponent<Property>("Lesson", "yet another lesson"),
                        Children = new List<TreeNode>
                        {

                        }
                    },
                    new TreeNode
                    {
                        Children = new List<TreeNode>
                        {

                        }
                    },
                }
            },

            new TreeNode
            {
                Identity = new IdentityVM("ThirdID", "Sup!"),
                Children = new List<TreeNode>
                {
                    new TreeNode
                    {
                        Children = new List<TreeNode>
                        {

                        }
                    },
                    new TreeNode
                    {
                        Children = new List<TreeNode>
                        {

                        }
                    },
                }
            },
        }
    };
}
